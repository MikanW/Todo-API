# Todo list REST API
当プロジェクトは、Spring Boot・MySQLにより、Todoアイテムの取得・追加・更新・削除のAPIを提供する。

## プロジェクトの構成

```
.
│   ├── main
│   │   ├── java
│   │   │   └── com
│   │   │       └── todo
│   │   │           └── app
│   │   │               ├── ApiApplication.java // メインクラス
│   │   │               ├── api/        // REST API
│   │   │               ├── dto/        // データ転換オブジェクト・機能を提供する
│   │   │               ├── entity/     //　DB用Entity
│   │   │               ├── exception/  //　例外
│   │   │               ├── repository/ //　DBアクセス処理
│   │   │               ├── service/    //  業務ロジック
│   │   │               └── util/       //　共通ライブラリー
│   └── test/                                       //　単体テスト
```

## こだわり

### データベース設計面
アイテム保存用テーブルは、以下となっている
```agsl
+---------+---------------+------+-----+---------+----------------+
| Field   | Type          | Null | Key | Default | Extra          |
+---------+---------------+------+-----+---------+----------------+
| id      | int           | NO   | PRI | NULL    | auto_increment |
| title   | varchar(50)   | YES  |     | NULL    |                |
| detail  | varchar(1000) | YES  |     | NULL    |                |
| status  | tinyint       | NO   |     | NULL    |                |
| due     | bigint        | YES  |     | NULL    |                |
| ctime   | bigint        | NO   |     | NULL    |                |
| mtime   | bigint        | NO   |     | NULL    |                |
| dtime   | bigint        | YES  |     | NULL    |                |
| deleted | tinyint(1)    | NO   |     | NULL    |                |
+---------+---------------+------+-----+---------+----------------+
```
#### データ型のサイズ
各Fieldが使用するデータTypeは、情報を保存できる範囲で、サイズが小さいほうとする。
例：各種時間はbigint(JavaのLong)とし、Unixタイムスタンプを保存する。
　　ステータスは文字列ではなくて、数字コードで保存する。

#### 削除フラグ
真偽型の削除フラグを設置している。
将来的な機能追加を考慮し、APIによりアイテムを削除時、本当にDBからレコードを削除ではなく、フラグをONにする。

#### 各種時間
アイテムの期限以外に、作成時間・前回更新時間・完了時間のFieldも設置している。
今回仕様は特に指定していないが、全アイテムを取得APIについては、何らかの順番でソートするはずなので、
起票順・完了順・最近変更順なども想定し、上記Fieldを設置した。

### 実装面

#### デカップリング考慮
API(Controller), 業務ロジック(Service), DB処理(Repository)の３層構成

#### Entity（DB用）とDTO（APIやり取り用）を分ける
以下のメリットを考えた結果、アイテムを定義するクラスは、２種類としている。

- デカップリングのため。フロント側仕様変更しても、DBまで大きな改修ではなく、DTO仕様を修正で済む。
    例:DB保存の「期限」はタイムスタンプ形式で、APIより取得する場合、DTOより仕様規定の"yyyy-MM-dd"形式で提供する。
    仕様が変更となる場合。
- 必要だけのデータ、APIとやり取りをし、ネットワークコストの削減ができる。また、DBの構成もバレないようにできる。
- 将来機能拡張がしやすい。
　例：アイテムデータを全く違うフォーマットのデータを提供するためには、さらにDTOを追加だけで良い。

#### Enumを活用
TableのFiledや、アイテムのステータスなど、一定の範囲から値を決定する項目は、Enumクラスを設置している。
また、Enumクラスにメソッドも追加。（例：Statusの文字列から、数値コードを決定するメソッド。各Fieldは、リクエストより更新可否を判断するメソッド。）
関連機能を一箇所に揃い、拡張・保守しやすい。



